import Head from 'next/head'
import Image from 'next/image'
import { Inter } from '@next/font/google'
import styles from '@/styles/Home.module.css'
import Men from './men/Men'
import styled from 'styled-components'
import Banner from '@/components/Banner'
import { extendedClothesSlice, selectClothesData, useGetAllClothesQuery , Clothes} from 'lib/clothesSlice'
import { store } from 'lib/store'
import ClothesGallery from '@/components/ClothesGallery'
import { useAppSelector } from 'lib/hooks/hooks'

const inter = Inter({ subsets: ['latin'] })

store.dispatch(extendedClothesSlice.endpoints.getAllClothes.initiate())


export default function Home() {

  const Clothes: Clothes | undefined = useAppSelector(selectClothesData)
  let randomClothes: any[]
  
  const {
    isLoading,
    isSuccess,
    isError,
    error
  } = useGetAllClothesQuery()

  if (isLoading) {
    console.log('LOADING')
  } else if (isSuccess) {
    randomClothes = [...Object.values(Clothes!.data.shirts),
      ...Object.values(Clothes!.data.shorts),
      ...Object.values(Clothes!.data.shoes)
      ].sort(() => Math.random() - 0.5)
    console.log('SUCCESS')
  } else if (isError) {
    console.log(JSON.stringify(error))
  }

  const firstBanner = {
    banner: '#95f7e5',
    header: 'UP TO 30% OFF ',
    header2: ' SELECTED STOCK',
    subheader: 'Surprise discount unlocked',
    subheader2: 'With code: ',
    subheader3: 'SURPRISE'
  } as const
  const secondBanner = {
    banner: '#FF385C',
    header: 'UP TO 50% OFF ',
    header2: ' SUMMER STUFF',
    subheader: 'ITS HOT OUT THERE',
    subheader2: '',
    subheader3: ''
  } as const



  return (
    <>
      <Head>
        <title>MERN eCommerse </title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Wrapper>
        <Banner info={firstBanner} />
          {isSuccess && <ClothesGallery info={randomClothes!} />}
        <Banner info={secondBanner} />
      </Wrapper>

    </>
  )
}

const Wrapper = styled.main`
  position: absolute;
  left: 0;
  top: 155px;
  width: 100%;
  height: auto;
`
